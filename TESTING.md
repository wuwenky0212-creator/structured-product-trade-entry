# 测试文档

## 测试环境准备

1. 确保已安装 Node.js (>= 16.0.0) 和 npm
2. 安装项目依赖：
```bash
npm install
```

3. 启动开发服务器：
```bash
npm run dev
```

开发服务器将在 `http://localhost:3000` 启动

## 功能测试清单

### 1. 基础界面测试

- [ ] 页面能够正常加载，无控制台错误
- [ ] 左侧导航菜单正常显示
- [ ] 右侧风险检查面板正常显示
- [ ] 顶部工具栏图标正常显示

### 2. 产品类型选择测试

#### 2.1 SnowBall (雪球期权)
- [ ] 选择"雪球期权 (SnowBall)"后，页面标题更新为"雪球期权 交易录入"
- [ ] 结构参数表单中显示以下字段：
  - 期初价格
  - 敲出价格(%)
  - 降敲幅度(%)
  - 敲出票息率(%)
  - 敲出观察频率
  - 支付频率
  - **敲入价格(%)** - 仅SnowBall显示
  - **敲入观察频率** - 仅SnowBall显示
  - **保底收益率** - 仅SnowBall显示

#### 2.2 AutoCall (自动敲出)
- [ ] 选择"自动敲出 (AutoCall)"后，页面标题更新为"自动敲出 交易录入"
- [ ] 结构参数表单中**不显示**以下字段：
  - 敲入价格(%)
  - 敲入观察频率
  - 保底收益率

### 3. 交易信息表单测试

#### 3.1 产品基本信息
- [ ] 产品结构下拉框可选择 SnowBall 或 AutoCall
- [ ] 挂钩类型下拉框可选择 Equity 或 Stock
- [ ] 挂钩标的下拉框可搜索并选择（如：中证500）
- [ ] 选择挂钩标的后，当前市价自动填充
- [ ] 交易方向可选择 BUY 或 SELL

#### 3.2 日期字段
- [ ] 交易日默认显示当前系统日期
- [ ] 选择交易日后，起息日自动设置为交易日+1
- [ ] 起息日默认等于定价日（如果定价日为空）
- [ ] 输入期限（如：6M, 1Y）后，到期日自动计算
- [ ] 到期日字段为禁用状态（只读）
- [ ] 结算日默认为到期日+2天

#### 3.3 金额字段
- [ ] 本金金额可输入，支持小数点后2位
- [ ] 选择本金货币为CNY后，计息基础自动设置为 ACT/365
- [ ] 本金金额和本金货币字段联动

### 4. 结构参数表单测试

#### 4.1 基础参数
- [ ] 期初价格可输入
- [ ] 敲出价格(%)可输入（如：103）
- [ ] 降敲幅度(%)可输入（如：0.5）
- [ ] 敲出票息率(%)可输入（如：15.00）
- [ ] 敲出观察频率可选择（默认：1M）
- [ ] 支付频率默认为MT且禁用

#### 4.2 SnowBall特有字段
- [ ] 敲入价格(%)可输入（如：80）
- [ ] 敲入观察频率可选择（默认：1D）
- [ ] 保底收益率可输入（默认：0）

#### 4.3 降敲计算测试
- [ ] 输入期初价格：6000
- [ ] 输入敲出价格(%)：103
- [ ] 输入降敲幅度(%)：1.00
- [ ] 输入期限：6M
- [ ] 输入敲出观察频率：1M
- [ ] 点击"规则设置"，设置起始日和结束日
- [ ] 观察表中第1期敲出价格应为：6180.00 (6000 * 1.03)
- [ ] 观察表中第2期敲出价格应为：6120.00 (6000 * 1.02)
- [ ] 观察表中第3期敲出价格应为：6060.00 (6000 * 1.01)
- [ ] ...以此类推

### 5. 交易账户表单测试

- [ ] 账户下拉框可选择账户
- [ ] 选择账户后，账户名称自动填充且禁用
- [ ] 交易对手下拉框可选择交易对手
- [ ] 选择交易对手后，交易对手名称自动填充且禁用

### 6. 规则设置测试

- [ ] 点击"规则设置"按钮，弹窗正常显示
- [ ] 生成规则可选择"从前往后"或"从后往前"
- [ ] 起始日默认等于起息日
- [ ] 结束日默认等于到期日
- [ ] 假日规则可多选（默认：CNY）
- [ ] 假日调整惯例可选择（默认：Modified Following）
- [ ] 点击"取消"按钮，弹窗关闭且不保存更改
- [ ] 点击"确定"按钮，保存设置并更新观察表

### 7. 观察表测试

#### 7.1 自动生成
- [ ] 填写完整的交易信息和结构参数后，观察表自动生成
- [ ] 观察表包含以下列：
  - 期数
  - 实际观察日
  - 观察指标
  - 实际定盘价（显示为 "--"）
  - 敲出价格
  - 敲入价格（仅SnowBall显示）
  - 潜在票息金额
  - 状态（显示为"待观察"）

#### 7.2 数据验证
- [ ] 期数从1开始递增
- [ ] 观察日期按设置的频率递增
- [ ] 敲出价格按降敲规则递减（如果有降敲）
- [ ] 潜在票息金额随持有天数增加而增加

#### 7.3 分页功能
- [ ] 观察表支持分页（默认每页20条）
- [ ] 可以切换每页显示数量（10, 20, 50, 100）
- [ ] 可以跳转到指定页码

#### 7.4 导出功能
- [ ] 点击"导出"按钮，显示相应提示（功能开发中）

### 8. 表单验证测试

#### 8.1 必填字段验证
- [ ] 未选择产品结构，点击"提交"，显示错误提示
- [ ] 未填写本金金额或金额<=0，点击"提交"，显示错误提示
- [ ] 未填写其他必填字段，显示相应错误提示

#### 8.2 字段联动验证
- [ ] 起息日不能早于交易日
- [ ] 定价日不能晚于起息日
- [ ] 到期日必须晚于起息日
- [ ] 结算日不能早于到期日
- [ ] 敲入价格必须小于敲出价格（SnowBall）

### 9. 一键清空测试

- [ ] 点击"一键清空"按钮，所有表单字段被重置
- [ ] 观察表被清空
- [ ] 交易日恢复为当前日期

### 10. 提交功能测试

- [ ] 填写完整表单后，点击"提交"按钮
- [ ] 控制台输出提交的数据
- [ ] 显示"提交成功"提示信息

### 11. 右侧风险检查面板测试

- [ ] 现金流预览：点击显示相应提示
- [ ] 操作风险检查：点击显示相应提示，点击刷新图标刷新状态
- [ ] 信用风险检查：点击显示相应提示，点击刷新图标刷新状态
- [ ] 市场风险检查：点击显示相应提示，点击刷新图标刷新状态

## 边界情况测试

### 日期边界
- [ ] 期限输入无效格式（如：abc），到期日不计算
- [ ] 期限输入为0或负数，到期日不计算

### 数值边界
- [ ] 本金金额输入负数，显示验证错误
- [ ] 敲出价格输入负数或0，显示验证错误
- [ ] 降敲幅度输入负数，显示验证错误

### 观察表边界
- [ ] 未填写起息日或到期日，观察表为空
- [ ] 未填写期初价格，观察表为空
- [ ] 期限很短（如：1M），观察表只有1-2行数据

## 性能测试

- [ ] 生成大量观察数据（如：24期）时，页面响应正常
- [ ] 频繁切换产品类型，页面不卡顿
- [ ] 频繁修改表单字段，观察表更新及时

## 浏览器兼容性测试

- [ ] Chrome 最新版本
- [ ] Firefox 最新版本
- [ ] Edge 最新版本
- [ ] Safari 最新版本（如果可能）

## 测试数据示例

### SnowBall 测试数据
```
产品结构：雪球期权 (SnowBall)
挂钩类型：股票 (Stock)
挂钩标的：中证500 (SH000905)
当前市价：6000
交易方向：买入 (BUY)
交易日：2025-01-27
起息日：2025-01-28
定价日：2025-01-28
期限：6M
到期日：2025-07-28（自动计算）
结算日：2025-07-30
本金金额：1000000
本金货币：CNY
计息基础：ACT/365

期初价格：6000
敲出价格(%)：103
降敲幅度(%)：1.00
敲出票息率(%)：15.00
敲出观察频率：1M
敲入价格(%)：80
敲入观察频率：1D
保底收益率：0
```

### AutoCall 测试数据
```
产品结构：自动敲出 (AutoCall)
挂钩类型：股票 (Stock)
挂钩标的：中证500 (SH000905)
当前市价：6000
交易方向：买入 (BUY)
交易日：2025-01-27
起息日：2025-01-28
定价日：2025-01-28
期限：6M
到期日：2025-07-28（自动计算）
结算日：2025-07-30
本金金额：1000000
本金货币：CNY
计息基础：ACT/365

期初价格：6000
敲出价格(%)：103
降敲幅度(%)：0.50
敲出票息率(%)：15.00
敲出观察频率：1M
```

## 已知问题

1. 观察表生成功能需要完善工作日历计算逻辑
2. 导出功能尚未实现
3. 风险检查功能尚未连接后端API
4. 数据持久化功能尚未实现

## 测试报告模板

测试日期：___________
测试人员：___________

### 测试结果摘要
- 通过测试：___/___
- 失败测试：___/___
- 跳过测试：___/___

### 主要问题记录
1. 
2. 
3. 


